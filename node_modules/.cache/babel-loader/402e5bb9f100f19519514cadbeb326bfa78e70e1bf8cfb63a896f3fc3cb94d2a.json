{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\User\\\\OneDrive\\\\Documents\\\\GitHub\\\\Campuscrush\\\\src\\\\pages\\\\DirectMessage.js\",\n  _s = $RefreshSig$();\n// src/pages/DirectMessage.js\nimport React, { useState } from 'react';\nimport { auth, db } from '../firebase/firebaseConfig';\nimport { doc, getDoc, setDoc, collection, addDoc } from 'firebase/firestore';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function DirectMessage() {\n  _s();\n  const [receiverId, setReceiverId] = useState('');\n  const [message, setMessage] = useState('');\n  const sendDM = async () => {\n    const sender = auth.currentUser;\n    if (!sender || !receiverId || !message.trim()) {\n      alert('Please enter all fields');\n      return;\n    }\n\n    // 游대 Check coin balance\n    const coinRef = doc(db, 'coins', sender.uid);\n    const coinSnap = await getDoc(coinRef);\n    const currentCoins = coinSnap.exists() ? coinSnap.data().balance : 0;\n    if (currentCoins < 1) {\n      alert(\"You don't have enough coins. Please buy more.\");\n      return;\n    }\n\n    // 游리 Deduct 1 coin\n    await setDoc(coinRef, {\n      balance: currentCoins - 1\n    });\n\n    // 游눫 Send message anyway\n    const chatId = sender.uid > receiverId ? `${sender.uid}_${receiverId}` : `${receiverId}_${sender.uid}`;\n    await addDoc(collection(db, 'messages', chatId, 'chat'), {\n      from: sender.uid,\n      to: receiverId,\n      text: message,\n      timestamp: new Date()\n    });\n    alert('Message sent successfully!');\n    setMessage('');\n    setReceiverId('');\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen bg-pink-50 p-6 flex flex-col items-center justify-center\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white shadow-lg p-6 rounded-md w-full max-w-md\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-xl font-bold mb-4\",\n        children: \"\\uD83D\\uDC8C Direct Message (Without Match)\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 58,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        placeholder: \"Enter Receiver's UID\",\n        className: \"w-full border p-2 rounded mb-3\",\n        value: receiverId,\n        onChange: e => setReceiverId(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n        rows: 4,\n        placeholder: \"Your message...\",\n        className: \"w-full border p-2 rounded mb-3\",\n        value: message,\n        onChange: e => setMessage(e.target.value)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: sendDM,\n        className: \"w-full bg-pink-500 text-white py-2 rounded\",\n        children: \"Send Message (Cost: 1 Coin)\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 5\n  }, this);\n}\n_s(DirectMessage, \"T1TDj2oyCNMcgRx/tJ/mkoaJ3pc=\");\n_c = DirectMessage;\nvar _c;\n$RefreshReg$(_c, \"DirectMessage\");","map":{"version":3,"names":["React","useState","auth","db","doc","getDoc","setDoc","collection","addDoc","jsxDEV","_jsxDEV","DirectMessage","_s","receiverId","setReceiverId","message","setMessage","sendDM","sender","currentUser","trim","alert","coinRef","uid","coinSnap","currentCoins","exists","data","balance","chatId","from","to","text","timestamp","Date","className","children","fileName","_jsxFileName","lineNumber","columnNumber","type","placeholder","value","onChange","e","target","rows","onClick","_c","$RefreshReg$"],"sources":["C:/Users/User/OneDrive/Documents/GitHub/Campuscrush/src/pages/DirectMessage.js"],"sourcesContent":["// src/pages/DirectMessage.js\r\nimport React, { useState } from 'react';\r\nimport { auth, db } from '../firebase/firebaseConfig';\r\nimport {\r\n  doc,\r\n  getDoc,\r\n  setDoc,\r\n  collection,\r\n  addDoc,\r\n} from 'firebase/firestore';\r\n\r\nexport default function DirectMessage() {\r\n  const [receiverId, setReceiverId] = useState('');\r\n  const [message, setMessage] = useState('');\r\n\r\n  const sendDM = async () => {\r\n    const sender = auth.currentUser;\r\n\r\n    if (!sender || !receiverId || !message.trim()) {\r\n      alert('Please enter all fields');\r\n      return;\r\n    }\r\n\r\n    // 游대 Check coin balance\r\n    const coinRef = doc(db, 'coins', sender.uid);\r\n    const coinSnap = await getDoc(coinRef);\r\n    const currentCoins = coinSnap.exists() ? coinSnap.data().balance : 0;\r\n\r\n    if (currentCoins < 1) {\r\n      alert(\"You don't have enough coins. Please buy more.\");\r\n      return;\r\n    }\r\n\r\n    // 游리 Deduct 1 coin\r\n    await setDoc(coinRef, { balance: currentCoins - 1 });\r\n\r\n    // 游눫 Send message anyway\r\n    const chatId =\r\n      sender.uid > receiverId\r\n        ? `${sender.uid}_${receiverId}`\r\n        : `${receiverId}_${sender.uid}`;\r\n\r\n    await addDoc(collection(db, 'messages', chatId, 'chat'), {\r\n      from: sender.uid,\r\n      to: receiverId,\r\n      text: message,\r\n      timestamp: new Date(),\r\n    });\r\n\r\n    alert('Message sent successfully!');\r\n    setMessage('');\r\n    setReceiverId('');\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-pink-50 p-6 flex flex-col items-center justify-center\">\r\n      <div className=\"bg-white shadow-lg p-6 rounded-md w-full max-w-md\">\r\n        <h2 className=\"text-xl font-bold mb-4\">游눏 Direct Message (Without Match)</h2>\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Enter Receiver's UID\"\r\n          className=\"w-full border p-2 rounded mb-3\"\r\n          value={receiverId}\r\n          onChange={e => setReceiverId(e.target.value)}\r\n        />\r\n        <textarea\r\n          rows={4}\r\n          placeholder=\"Your message...\"\r\n          className=\"w-full border p-2 rounded mb-3\"\r\n          value={message}\r\n          onChange={e => setMessage(e.target.value)}\r\n        />\r\n        <button\r\n          onClick={sendDM}\r\n          className=\"w-full bg-pink-500 text-white py-2 rounded\"\r\n        >\r\n          Send Message (Cost: 1 Coin)\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}